<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Öğrenci Kargo Yardım - Kampüs Kargo Ağı</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        .hero-section {
            background: linear-gradient(rgba(40,57,101,.9), rgba(40,57,101,.9)),
                        url('https://example.com/students-helping.jpg');
            background-size: cover;
            color: white;
            padding: 50px 0;
        }
        
        .role-card {
            transition: transform 0.3s;
            border: none;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .role-card:hover {
            transform: translateY(-10px);
        }
        
        .task-badge {
            font-size: 0.9rem;
            margin: 5px;
        }
        
        .student-avatar {
            width: 60px;
            height: auto;
            object-fit: cover;
        }
        
        
        
    </style>
</head>
<body>


<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
    <div class="container">
        <a class="navbar-brand text-custom-primary fw-bold" href="#">
            <img [src]="logoPath" alt="logo" class="navbar-logo">
            
        </a>
        <div class="d-flex align-items-center gap-3">
            
            <div *ngIf="userName; else guest">
               
                <div class="dropdown">
                    <a class="btn btn-link text-light text-decoration-none dropdown-toggle" 
                    href="#" role="button" data-bs-toggle="dropdown">
                        <i class="fas fa-user-circle me-2"></i>
                        {{userName}}
                    </a>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li><a class="dropdown-item" href="/profile">
                            <i class="fas fa-user me-2"></i>Profilim
                        </a></li>
                        <li><a class="dropdown-item" [routerLink]="['/profile']" [queryParams]="{ tab: 'settings'}">
                            <i class="fas fa-cog me-2"></i>Ayarlar
                        </a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item text-danger" href="/cikis" (click)="logout()">
                            <i class="fas fa-sign-out-alt me-2"></i>Çıkış Yap
                        </a></li>
                    </ul>
                </div>
            </div>
            <ng-template #guest>
                <a routerLink="/login" class="btn btn-outline-primary">Giriş Yap</a>
                <a routerLink="/signup" class="btn btn-outline-primary">Kaydol</a>  
            </ng-template>
        </div>
    </div>
</nav>


<section class="hero-section bg-custom-primary">
    <div class="container text-center">
        <h1 class="display-4 mb-4 fw-bold">Yurtify, Kargo Hizmetiniz</h1>
        <p class="lead mb-4">Kargo ihtiyaçlarınız için  öğrenci yardımcılarla buluşun</p>
        <div class="row g-4 justify-content-center">
            <div class="col-md-5">
                <div class="card role-card h-100">
                    <div class="card-body">
                        <i class="fas fa-box-open fa-3x text-custom-primary mb-3"></i>
                        <h3>Kargo Sahipleri</h3>
                        <p>Güvenilir öğrencilerle kargo ihtiyaçlarınızı çözün</p>
                        <a routerLink="/cargo-request-create"class="btn btn-primary w-100">Talep Oluştur</a>
                    </div>
                </div>
            </div>
            <div class="col-md-5">
                <div class="card role-card h-100">
                    <div class="card-body">
                        <i class="fas fa-hands-helping fa-3x text-custom-primary mb-3"></i>
                        <h3>Öğrenci Yardımcılar</h3>
                        <p>Kampüs içi kargo taşıyarak para kazanın</p>
                        <button class="btn btn-primary w-100" (click)="scrollToAktifListelemeler()">Yardımcı Ol</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>


<section class="py-5 bg-light">
    <div class="container">
        <h2 class="text-center mb-5">Nasıl Çalışır?</h2>
        <div class="row g-4">
            <div class="col-md-4 text-center">
                <div class="bg-custom-primary text-white rounded-circle p-4 d-inline-block mb-3">
                    <i class="fas fa-edit fa-2x"></i>
                </div>
                <h4>1. İsteğini Gönder</h4>
                <p>Kargo ihtiyacını anlat ve bütçeni belirle</p>
            </div>
            <div class="col-md-4 text-center">
                <div class="bg-custom-secondary text-white rounded-circle p-4 d-inline-block mb-3">
                    <i class="fas fa-users fa-2x"></i>
                </div>
                <h4>2. Yardımcılarla Eşleş</h4>
                <p>Doğrulanmış öğrenciler teklif verecek</p>
            </div>
            <div class="col-md-4 text-center">
                <div class="bg-custom-warning text-white rounded-circle p-4 d-inline-block mb-3">
                    <i class="fas fa-check-circle fa-2x"></i>
                </div>
                <h4>3. Teslimatı Tamamla</h4>
                <p>Başarılı teslimat sonrası ödemeni al</p>
            </div>
        </div>
    </div>
</section>


<section class="py-5" id="aktif-listelemeler">
    <div class="container">
        <h2 class="mb-4 text-center">Açık Teslimat İstekleri</h2>

        
        <div *ngIf="isLoadingCargoRequests" class="text-center">
            <p>Kargo istekleri yükleniyor...</p>
            
        </div>
        
        <div *ngIf="cargoRequestsError && !isLoadingCargoRequests" class="alert alert-danger">
            {{ cargoRequestsError }}
        </div>


        <div *ngIf="!isLoadingCargoRequests && !cargoRequestsError && openCargoRequests.length === 0" class="alert alert-info text-center">
            Şu anda açık teslimat isteği bulunmamaktadır.
        </div>

        <!-- Kargo Listesi -->
        <div *ngIf="!isLoadingCargoRequests && !cargoRequestsError && openCargoRequests.length > 0" class="row g-4">
            <!-- Dinamik Talep Kartı -->
            <div *ngFor="let request of openCargoRequests" class="col-md-4 d-flex">
                <div class="card h-100 w-100">
                    <div class="card-body d-flex flex-column">
                        <!-- ... Kartın mevcut içeriği (başlık, açıklama, gönderen vb.) ... -->
                        <div class="d-flex justify-content-between mb-3">
                            <span class="badge bg-custom-primary">{{ request.status || 'Paket' }}</span>
                            <span class="text-muted" *ngIf="request.paymentProposedFee != null">{{ request.paymentProposedFee | currency:'TRY':'symbol' }}</span>
                        </div>
                        <h5 class="card-title">{{ request.cargoDescription || 'Açıklama Yok' }}</h5>
                        <p class="text-muted card-text mb-auto">
                            <i class="fas fa-map-marker-alt me-1"></i> {{ request.cargoPickupLocation || 'Belirtilmemiş' }}
                            <i class="fas fa-long-arrow-alt-right mx-1"></i>
                            <i class="fas fa-map-marker-alt me-1"></i> {{ request.cargoDeliveryLocation || 'Belirtilmemiş' }}
                        </p>
                        <div class="d-flex align-items-center mt-3 pt-3 border-top">
                            <i class="fas fa-user-circle fa-2x text-secondary me-2"></i>
                            <div>
                                <small>Gönderen:</small>
                                <div class="fw-bold">{{ request.requestedByUser?.userName || (request.requestedByUser?.firstName + ' ' + request.requestedByUser?.lastName) || request.senderName || 'Bilinmiyor' }}</div>
                            </div>
                        </div>
                    </div>
                    <div class="card-footer bg-white">
                        <!-- Detayları Gör butonu toggleDetails metodunu çağıracak -->
                        <button (click)="toggleDetails(request.id)" class="btn btn-outline-primary w-100">
                            {{ selectedCargoId === request.id ? 'Detayları Gizle' : 'Detayları Gör' }}
                        </button>
                    </div>

                    <!-- Satır İçi Detay Bölümü (Kartın hemen altında) -->
                    <div *ngIf="selectedCargoId === request.id" class="inline-details p-3 border-top bg-light">
                        <h6 class="mb-3">Ek Detaylar:</h6>
                        <p *ngIf="request.trackingNumber"><strong>Takip No:</strong> {{ request.trackingNumber }}</p>
                        <p *ngIf="request.cargoSpecialInstructions"><strong>Özel Talimatlar:</strong> {{ request.cargoSpecialInstructions }}</p>
                        <p *ngIf="request.senderName"><strong>Gönderen Adı (Detay):</strong> {{ request.senderName }}</p>
                        <p *ngIf="request.senderContactInfo"><strong>Gönderen İletişim:</strong> {{ request.senderContactInfo }}</p>
                        <p *ngIf="request.receiverName"><strong>Alıcı Adı:</strong> {{ request.receiverName }}</p>
                        <p *ngIf="request.receiverContactInfo"><strong>Alıcı İletişim:</strong> {{ request.receiverContactInfo }}</p>
                        <p *ngIf="request.createdAt"><strong>Oluşturulma:</strong> {{ request.createdAt | date:'dd/MM/yyyy HH:mm' }}</p>
                        
                        <!-- Kargoyu Alma Butonu -->
                        <div *ngIf="request.status === 'Pending' && request.requestedByUser?.id !== currentUserId" class="mt-3">
                            <button (click)="acceptCargoRequest(request.id)" class="btn btn-success w-100">
                                <i class="fas fa-hand-holding-heart me-2"></i>Kargoyu Al
                            </button>
                        </div>
                        <div *ngIf="request.requestedByUser?.id === currentUserId" class="alert alert-sm alert-info mt-2 mb-0">
                            Bu sizin oluşturduğunuz bir kargo talebi.
                        </div>
                        <div *ngIf="request.status !== 'Pending' && request.requestedByUser?.id !== currentUserId" class="alert alert-sm alert-warning mt-2 mb-0">
                            Bu kargo şu anda alınabilir durumda değil (Durum: {{request.status}}).
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>


<section class="py-5 bg-custom-primary text-white">
    <div class="container">
        <div class="row g-4">
            <div class="col-md-4 text-center">
                <i class="fas fa-shield-alt fa-3x mb-3"></i>
                <h4>Doğrulanmış Öğrenciler</h4>
                <p>Tüm yardımcılar öğrenci kimliği ile doğrulanır</p>
            </div>
            <div class="col-md-4 text-center">
                <i class="fas fa-lock fa-3x mb-3"></i>
                <h4>Güvenli Ödemeler</h4>
                <p>Havuz sistemi ile güvenli işlemler</p>
            </div>
            <div class="col-md-4 text-center">
                <i class="fas fa-clock fa-3x mb-3"></i>
                <h4>Esnek Zamanlama</h4>
                <p>Teslimat zamanını kendin belirle</p>
            </div>
        </div>
    </div>
</section>

<!-- Kayıt Çağrısı -->
<section class="py-5">
    <div class="container text-center">
        <h2 class="mb-4">Hemen Başlamaya Hazır mısın?</h2>
        <p class="lead mb-4">Yüzlerce öğrenci ve kargo sahibine katıl</p>
        <div class="d-flex justify-content-center gap-3">
            <button class="btn btn-primary btn-lg px-5">
                <i class="fas fa-box-open me-2"></i>Yardım Lazım
            </button>
            <button class="btn btn-success btn-lg px-5">
                <i class="fas fa-hand-holding-heart me-2"></i>Yardım Edebilirim
            </button>
        </div>
    </div>
</section>

<!-- Footer -->
<footer class="bg-dark text-light py-4">
    <div class="container">
        <div class="row g-4">
            <div class="col-md-4">
                <h5>ÖğrenciKargo</h5>
                <p>Kargo ihtiyaçlarını öğrencilerle buluşturuyoruz</p>
            </div>
            <div class="col-md-4">
                <h5>Hızlı Bağlantılar</h5>
                <ul class="list-unstyled">
                    <li><a href="#" class="text-light">Güvenlik Kuralları</a></li>
                    <li><a href="#" class="text-light">SSS</a></li>
                    <li><a href="#" class="text-light">Yardımcı Ol</a></li>
                </ul>
            </div>
            <div class="col-md-4">
                <h5>İletişim</h5>
                <ul class="list-unstyled">
                    <li><i class="fas fa-envelope me-2"></i>destek&#64;ogrencikargo.com.tr</li>
                    <li><i class="fas fa-phone me-2"></i>+90 (555) 123 45 67</li>
                </ul>
            </div>
        </div>
        <hr>
        <p class="text-center mb-0">&copy; 2023 ÖğrenciKargo. Tüm hakları saklıdır.</p>
    </div>
</footer>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>